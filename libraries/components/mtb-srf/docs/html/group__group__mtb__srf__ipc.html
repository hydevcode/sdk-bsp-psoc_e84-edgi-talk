<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Secure Request Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Secure Request Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__group__mtb__srf__ipc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">API Reference</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Secure Request IPC integration</div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<p >This library provides support for sending requests from an alternative core to the core with the secure paritition. </p>
<p >The non-secure partition acts as a relay to unpack the request sent over Infineon's interprocessor communication library (MTB-IPC) and submit it in the same way as other non-secure requests. The library also provides functionality to signal completion so the requesting core can view the results. This is accomplished through two roles: Client and Relay. The Client owns a pool of requests that are tied to IPC semaphores that will signal completion. The relay receives unpacks requests on the core containing the secure region before processing and signalling. This requires each of the contexts to be set up to create the relay relationship and begin submitting requests. Refer to SRF documentation <a class="el" href="group__group__mtb__srf.html">Secure Request Framework</a> for more information on secure requests and request pools. The APIs for submiting a request remain the same on all cores, but a client context must be set up on the core that needs IPC in order for the request to be sent correctly.</p>
<p >Refer to <a class="el" href="group__group__mtb__srf__ipc.html#group_mtb_srf_ipc_code_snippets">Code Snippets</a> for more information.</p>
<h1><a class="anchor" id="group_mtb_srf_ipc_prerequisites"></a>
Prerequisites</h1>
<p >The IPC components of the SRF IPC integration must be set up prior to transfer. Please refer to MTB-IPC documentation on how to setup an IPC instance and a mailbox for request transfer. The MTB SRF IPC will by default consume MTB_SRF_IPC_SEMA_COUNT + 3 semaphores for its own use.</p>
<h1><a class="anchor" id="section_impl_srf_ipc_request_data_"></a>
Request pool data memory allocation</h1>
<p >Request pool data memory allocation can be done with help of MTB_SRF_IPC_REQUEST_DATA_ALLOC macro, but using it is not mandatory, so user can allocate memory for the shared memory in any convenient for them way. This struct is necessary to store and keep track of all shared objects during operation.</p>
<h1><a class="anchor" id="group_mtb_srf_ipc_custom_packet"></a>
Custom Packet</h1>
<p >Many APIs can be overridden with macros to allow custom implementations. To support this, the <a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t" title="Default request structure for use in IPC-enabled SRF This couples normal SRF data with an IPC semapho...">mtb_srf_ipc_packet_t</a> type can be overriden via the define MTB_SRF_IPC_CUSTOM_PACKET_TYPE. However, the various APIs have minimum requirements on what this type defines.</p>
<p >mtb_srf_ipc_request_submit, overridden via MTB_SRF_CUSTOM_IPC_REQUEST_SUBMIT, requires all the default packet struct members to operate.</p>
<p >mtb_srf_ipc_process_request, overridden via MTB_SRF_CUSTOM_PROCESS_REQUEST, requires the ioVec pointers and counts (inVec_ptr, inVec_cnt_ns, outVec_ptr, outVec_cnt_ns).</p>
<p >mtb_srf_ipc_signal_complete, which cannot be overriden, requires the semaphore_idx member.</p>
<p >All other APIs interact with the packet type as a pointer and aren't affected by the contents.</p>
<h1><a class="anchor" id="group_mtb_srf_ipc_code_snippets"></a>
Code Snippets</h1>
<p >Register a Client and transfer request </p><div class="fragment"><div class="line">uint32_t IPC_SEMAPHORE_INDEXES[] = { 1UL, 2UL, 3UL, 4UL, 5UL, 6UL };</div>
<div class="line"><span class="preprocessor">#define IPC_NUM_REQ_IN_POOL (6UL)</span></div>
<div class="line">CY_SECTION_SHAREDMEM <a class="code hl_struct" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> ipc_requests[IPC_NUM_REQ_IN_POOL] <a class="code hl_define" href="group__group__mtb__srf.html#ga658a13a20dd628548ad16d7bd06cc278">_MTB_SRF_DATA_ALIGN</a>;</div>
<div class="line"><span class="comment">/* NOTE: A default client context, &quot;cybsp_mtb_srf_client_context&quot;, is declared in the BSP */</span></div>
<div class="line">mtb_srf_ipc_client_context_t example_srf_client_context;</div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// snippet_mtb_srf_ipc_client</span></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line">cy_rslt_t snippet_mtb_srf_ipc_client(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    mtb_ipc_mbox_sender_t sender;</div>
<div class="line">    mtb_srf_ipc_pool_t ipc_pool;</div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__pool__cfg__t">mtb_srf_ipc_pool_cfg_t</a> pool_cfg;</div>
<div class="line">    mtb_ipc_semaphore_t ipc_semaphores[IPC_NUM_REQ_IN_POOL];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Assume IPC instance, mailbox, and semaphores are already initialized</span></div>
<div class="line">    <span class="comment">// Refer to MTB IPC documentation for more information</span></div>
<div class="line"> </div>
<div class="line">    pool_cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#a1f8112e8aa16010439bb40758eed2621">request_pool</a> = (<a class="code hl_struct" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a>*)ipc_requests;</div>
<div class="line">    pool_cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#a84afd0210cfa6e06697d227b2b7d8f9c">request_semaphores</a> = (mtb_ipc_semaphore_t*)ipc_semaphores;</div>
<div class="line">    pool_cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#a862819fa5cd4d7fbc4fd12978af53fc6">num_semaphores</a> = IPC_NUM_REQ_IN_POOL;</div>
<div class="line">    pool_cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#aa7ec9551276bcdd9a1bb34cee98e41ab">num_requests</a> = IPC_NUM_REQ_IN_POOL;</div>
<div class="line"> </div>
<div class="line">    cy_rslt_t result = <a class="code hl_function" href="group__group__mtb__srf__ipc__init.html#gaf56de7d8077e7785327e15bd1923aa0d">mtb_srf_ipc_pool_init</a>(&amp;ipc_pool, &amp;pool_cfg);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__client__context__cfg__t">mtb_srf_ipc_client_context_cfg_t</a> client_cfg;</div>
<div class="line">    client_cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#aec82300c988a55e9f157913bb7f5b96e">mailbox_handle</a> = &amp;sender;</div>
<div class="line">    client_cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#aa3a642f3d6b345190c1604eb16269cc6">pool</a> = &amp;ipc_pool;</div>
<div class="line"> </div>
<div class="line">    result = <a class="code hl_function" href="group__group__mtb__srf__ipc__init.html#ga94d5de673c0f94868d11a5f961d624a2">mtb_srf_setup_client_context</a>(&amp;example_srf_client_context, &amp;client_cfg);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Assuming an already initialized request pool</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__structures.html#structmtb__srf__invec__ns__t">mtb_srf_invec_ns_t</a>* inVec = NULL;</div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__structures.html#structmtb__srf__outvec__ns__t">mtb_srf_outvec_ns_t</a>* outVec = NULL;</div>
<div class="line"> </div>
<div class="line">    result = <a class="code hl_function" href="group__group__mtb__srf__pool.html#ga4b50f4d61fcf862d51dbeee70f46bac6">mtb_srf_pool_allocate</a>(&amp;cy_pdl_srf_default_pool, &amp;inVec, &amp;outVec, 1000);</div>
<div class="line">    <span class="keywordflow">if</span> (result != CY_RSLT_SUCCESS)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> result;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Our first inVec is always a mtb_srf_input_ns_t */</span></div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__structures.html#structmtb__srf__input__ns__t">mtb_srf_input_ns_t</a>* input = (<a class="code hl_struct" href="group__group__mtb__srf__structures.html#structmtb__srf__input__ns__t">mtb_srf_input_ns_t</a>*)(inVec[0].base);</div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__structures.html#structmtb__srf__output__ns__t">mtb_srf_output_ns_t</a>* output = (<a class="code hl_struct" href="group__group__mtb__srf__structures.html#structmtb__srf__output__ns__t">mtb_srf_output_ns_t</a>*)(outVec[0].base);</div>
<div class="line"> </div>
<div class="line">    input-&gt;<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a86f82d68459addee7d412c2b8f9b639f">request</a>.<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a9169b0562b030274202ea9916cc08d12">module_id</a> = MTB_SRF_MODULE_PDL;</div>
<div class="line">    input-&gt;<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a86f82d68459addee7d412c2b8f9b639f">request</a>.<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a961fe725e10b275be3c8df7ad462e2b5">submodule_id</a> = CY_PDL_SRF_SUBMODULE_SYSCLK;</div>
<div class="line">    input-&gt;<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a86f82d68459addee7d412c2b8f9b639f">request</a>.<a class="code hl_variable" href="group__group__mtb__srf__structures.html#ab74532ba78f871bbc12cef238dcdd97c">op_id</a> = CY_SYSCLK_SRF_OP_HF_GET_FREQUENCY;</div>
<div class="line"> </div>
<div class="line">    input-&gt;<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a86f82d68459addee7d412c2b8f9b639f">request</a>.<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a7a8bfccbd766e9d89555cda6f33ff733">base</a> = NULL; <span class="comment">/* Base address not required for this function */</span></div>
<div class="line">    input-&gt;<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a86f82d68459addee7d412c2b8f9b639f">request</a>.<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a167b1b0ca4fc59a836051331bd05391e">sub_block</a> = 0UL; <span class="comment">/* sub block is hfclk instance */</span></div>
<div class="line"> </div>
<div class="line">    input-&gt;<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a1397f007a73a7dcc399fcc909ad668b2">len</a> = 0UL;</div>
<div class="line">    output-&gt;<a class="code hl_variable" href="group__group__mtb__srf__structures.html#a42ff923937d6d517a80965aa38554be3">len</a> = 1UL * <span class="keyword">sizeof</span>(uint32_t); <span class="comment">/* Store HF Clk Frequency */</span></div>
<div class="line"> </div>
<div class="line">    uint8_t inVec_cnt = 1;</div>
<div class="line">    uint8_t outVec_cnt = 1;</div>
<div class="line">    result = <a class="code hl_function" href="group__group__mtb__srf.html#gab26cb37c7cd980689eb5f49a308b4595">mtb_srf_request_submit</a>(inVec, inVec_cnt, outVec,</div>
<div class="line">                                    outVec_cnt);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__init_html_ga94d5de673c0f94868d11a5f961d624a2"><div class="ttname"><a href="group__group__mtb__srf__ipc__init.html#ga94d5de673c0f94868d11a5f961d624a2">mtb_srf_setup_client_context</a></div><div class="ttdeci">cy_rslt_t mtb_srf_setup_client_context(mtb_srf_ipc_client_context_t *client_context, mtb_srf_ipc_client_context_cfg_t *cfg)</div><div class="ttdoc">Initializes an secure request pool instance.</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__init_html_gaf56de7d8077e7785327e15bd1923aa0d"><div class="ttname"><a href="group__group__mtb__srf__ipc__init.html#gaf56de7d8077e7785327e15bd1923aa0d">mtb_srf_ipc_pool_init</a></div><div class="ttdeci">cy_rslt_t mtb_srf_ipc_pool_init(mtb_srf_ipc_pool_t *pool, mtb_srf_ipc_pool_cfg_t *cfg)</div><div class="ttdoc">Initializes an secure request pool instance.</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_a1f8112e8aa16010439bb40758eed2621"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#a1f8112e8aa16010439bb40758eed2621">mtb_srf_ipc_pool_cfg_t::request_pool</a></div><div class="ttdeci">mtb_srf_ipc_packet_t * request_pool</div><div class="ttdoc">Pointer to a section of memory allocated by the caller for the request pool.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:178</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_a84afd0210cfa6e06697d227b2b7d8f9c"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#a84afd0210cfa6e06697d227b2b7d8f9c">mtb_srf_ipc_pool_cfg_t::request_semaphores</a></div><div class="ttdeci">mtb_ipc_semaphore_t * request_semaphores</div><div class="ttdoc">Pointer to array of initialized IPC semaphore handles.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:183</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_a862819fa5cd4d7fbc4fd12978af53fc6"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#a862819fa5cd4d7fbc4fd12978af53fc6">mtb_srf_ipc_pool_cfg_t::num_semaphores</a></div><div class="ttdeci">uint32_t num_semaphores</div><div class="ttdoc">Numnber of semaphore.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:185</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_aa3a642f3d6b345190c1604eb16269cc6"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#aa3a642f3d6b345190c1604eb16269cc6">mtb_srf_ipc_client_context_cfg_t::pool</a></div><div class="ttdeci">mtb_srf_ipc_pool_t * pool</div><div class="ttdoc">Pool of memory and semaphores used to allocate for requests from a client process through the relay p...</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:195</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_aa7ec9551276bcdd9a1bb34cee98e41ab"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#aa7ec9551276bcdd9a1bb34cee98e41ab">mtb_srf_ipc_pool_cfg_t::num_requests</a></div><div class="ttdeci">uint32_t num_requests</div><div class="ttdoc">Numnber of requests.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:180</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_aec82300c988a55e9f157913bb7f5b96e"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#aec82300c988a55e9f157913bb7f5b96e">mtb_srf_ipc_client_context_cfg_t::mailbox_handle</a></div><div class="ttdeci">mtb_ipc_mbox_sender_t * mailbox_handle</div><div class="ttdoc">Pointer to the mailbox used to sed/receive data over IPC.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:197</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_structmtb__srf__ipc__client__context__cfg__t"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__client__context__cfg__t">mtb_srf_ipc_client_context_cfg_t</a></div><div class="ttdoc">A Client context config used to configure a client context.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:192</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_structmtb__srf__ipc__packet__t"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a></div><div class="ttdoc">Default request structure for use in IPC-enabled SRF This couples normal SRF data with an IPC semapho...</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc.h:121</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_structmtb__srf__ipc__pool__cfg__t"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__pool__cfg__t">mtb_srf_ipc_pool_cfg_t</a></div><div class="ttdoc">IPC Pool config, used to setup an SRF IPC pool.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:174</div></div>
<div class="ttc" id="agroup__group__mtb__srf__pool_html_ga4b50f4d61fcf862d51dbeee70f46bac6"><div class="ttname"><a href="group__group__mtb__srf__pool.html#ga4b50f4d61fcf862d51dbeee70f46bac6">mtb_srf_pool_allocate</a></div><div class="ttdeci">cy_rslt_t mtb_srf_pool_allocate(mtb_srf_pool_t *pool, mtb_srf_invec_ns_t **inVec, mtb_srf_outvec_ns_t **outVec, uint32_t timeout_us)</div><div class="ttdoc">Allocate secure request object within an secure request pool.</div><div class="ttdef"><b>Definition:</b> mtb_srf_pool.c:96</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_a1397f007a73a7dcc399fcc909ad668b2"><div class="ttname"><a href="group__group__mtb__srf__structures.html#a1397f007a73a7dcc399fcc909ad668b2">mtb_srf_input_ns_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdoc">Size of the input_values array.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:83</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_a167b1b0ca4fc59a836051331bd05391e"><div class="ttname"><a href="group__group__mtb__srf__structures.html#a167b1b0ca4fc59a836051331bd05391e">mtb_srf_request_ns_t::sub_block</a></div><div class="ttdeci">uint32_t sub_block</div><div class="ttdoc">Sub-block index for this operation.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:49</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_a42ff923937d6d517a80965aa38554be3"><div class="ttname"><a href="group__group__mtb__srf__structures.html#a42ff923937d6d517a80965aa38554be3">mtb_srf_output_ns_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdoc">Size of the output_values array.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:98</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_a7a8bfccbd766e9d89555cda6f33ff733"><div class="ttname"><a href="group__group__mtb__srf__structures.html#a7a8bfccbd766e9d89555cda6f33ff733">mtb_srf_request_ns_t::base</a></div><div class="ttdeci">void * base</div><div class="ttdoc">Register base address for the operation.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:48</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_a86f82d68459addee7d412c2b8f9b639f"><div class="ttname"><a href="group__group__mtb__srf__structures.html#a86f82d68459addee7d412c2b8f9b639f">mtb_srf_input_ns_t::request</a></div><div class="ttdeci">mtb_srf_request_ns_t request</div><div class="ttdoc">Request information.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:82</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_a9169b0562b030274202ea9916cc08d12"><div class="ttname"><a href="group__group__mtb__srf__structures.html#a9169b0562b030274202ea9916cc08d12">mtb_srf_request_ns_t::module_id</a></div><div class="ttdeci">uint8_t module_id</div><div class="ttdoc">ID of the module containing the requested operation.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:42</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_a961fe725e10b275be3c8df7ad462e2b5"><div class="ttname"><a href="group__group__mtb__srf__structures.html#a961fe725e10b275be3c8df7ad462e2b5">mtb_srf_request_ns_t::submodule_id</a></div><div class="ttdeci">uint8_t submodule_id</div><div class="ttdoc">ID of the submodule containing within the module.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:44</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_ab74532ba78f871bbc12cef238dcdd97c"><div class="ttname"><a href="group__group__mtb__srf__structures.html#ab74532ba78f871bbc12cef238dcdd97c">mtb_srf_request_ns_t::op_id</a></div><div class="ttdeci">uint8_t op_id</div><div class="ttdoc">ID of the requested operation within the submodule.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:46</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_structmtb__srf__input__ns__t"><div class="ttname"><a href="group__group__mtb__srf__structures.html#structmtb__srf__input__ns__t">mtb_srf_input_ns_t</a></div><div class="ttdoc">An input structure.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:81</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_structmtb__srf__invec__ns__t"><div class="ttname"><a href="group__group__mtb__srf__structures.html#structmtb__srf__invec__ns__t">mtb_srf_invec_ns_t</a></div><div class="ttdoc">An input vector - a section of memory to be used along with the length.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:64</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_structmtb__srf__output__ns__t"><div class="ttname"><a href="group__group__mtb__srf__structures.html#structmtb__srf__output__ns__t">mtb_srf_output_ns_t</a></div><div class="ttdoc">An input structure.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:96</div></div>
<div class="ttc" id="agroup__group__mtb__srf__structures_html_structmtb__srf__outvec__ns__t"><div class="ttname"><a href="group__group__mtb__srf__structures.html#structmtb__srf__outvec__ns__t">mtb_srf_outvec_ns_t</a></div><div class="ttdoc">An output vector - a section of memory to be used along with the length.</div><div class="ttdef"><b>Definition:</b> mtb_srf_iovec.h:71</div></div>
<div class="ttc" id="agroup__group__mtb__srf_html_ga658a13a20dd628548ad16d7bd06cc278"><div class="ttname"><a href="group__group__mtb__srf.html#ga658a13a20dd628548ad16d7bd06cc278">_MTB_SRF_DATA_ALIGN</a></div><div class="ttdeci">#define _MTB_SRF_DATA_ALIGN</div><div class="ttdoc">This define can be used for aligning address of the data structures with enabled Data Cache.</div><div class="ttdef"><b>Definition:</b> mtb_srf.h:122</div></div>
<div class="ttc" id="agroup__group__mtb__srf_html_gab26cb37c7cd980689eb5f49a308b4595"><div class="ttname"><a href="group__group__mtb__srf.html#gab26cb37c7cd980689eb5f49a308b4595">mtb_srf_request_submit</a></div><div class="ttdeci">cy_rslt_t mtb_srf_request_submit(mtb_srf_invec_ns_t *inVec_ns, uint8_t inVec_cnt_ns, mtb_srf_outvec_ns_t *outVec_ns, uint8_t outVec_cnt_ns)</div><div class="ttdoc">Submit a request from the non-secure side to the secure.</div></div>
</div><!-- fragment --><p >Register a Relay </p><div class="fragment"><div class="line"><span class="preprocessor">#define IPC_NUM_REQ_IN_POOL (6UL)</span></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// snippet_mtb_srf_ipc_relay_setup</span></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line">cy_rslt_t snippet_mtb_srf_ipc_relay_setup(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    mtb_ipc_mbox_receiver_t receiver;</div>
<div class="line">    mtb_srf_ipc_relay_context_t relay;</div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__relay__context__cfg__t">mtb_srf_ipc_relay_context_cfg_t</a> cfg;</div>
<div class="line">    mtb_ipc_semaphore_t ipc_semaphores[IPC_NUM_REQ_IN_POOL];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Assume IPC instance, mailbox, and semaphores are already initialized</span></div>
<div class="line">    <span class="comment">// See MTB IPC documentation for more information</span></div>
<div class="line">    cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#a522a8f0240d83b922c5d77403e97df0e">mailbox</a> = &amp;receiver;</div>
<div class="line">    cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#a001ce384c9e01952f88ef4e6b6b43807">request_semaphores</a> = (mtb_ipc_semaphore_t*)ipc_semaphores;</div>
<div class="line">    cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#a31bd923315d7bac8073cb9f94fa6eb08">num_semaphores</a> = IPC_NUM_REQ_IN_POOL;</div>
<div class="line">    cfg.<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#a068e34a4bf91189f297486e7aef91958">num_requests</a> = IPC_NUM_REQ_IN_POOL;</div>
<div class="line">    cy_rslt_t result = mtb_srf_setup_relay_context(&amp;relay, &amp;cfg);</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_a001ce384c9e01952f88ef4e6b6b43807"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#a001ce384c9e01952f88ef4e6b6b43807">mtb_srf_ipc_relay_context_cfg_t::request_semaphores</a></div><div class="ttdeci">mtb_ipc_semaphore_t * request_semaphores</div><div class="ttdoc">Pointer to array of initialized IPC semaphore handles.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:211</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_a068e34a4bf91189f297486e7aef91958"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#a068e34a4bf91189f297486e7aef91958">mtb_srf_ipc_relay_context_cfg_t::num_requests</a></div><div class="ttdeci">uint32_t num_requests</div><div class="ttdoc">Number of entries in the pool on the client core.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:213</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_a31bd923315d7bac8073cb9f94fa6eb08"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#a31bd923315d7bac8073cb9f94fa6eb08">mtb_srf_ipc_relay_context_cfg_t::num_semaphores</a></div><div class="ttdeci">uint32_t num_semaphores</div><div class="ttdoc">Number of semaphores.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:208</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_a522a8f0240d83b922c5d77403e97df0e"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#a522a8f0240d83b922c5d77403e97df0e">mtb_srf_ipc_relay_context_cfg_t::mailbox</a></div><div class="ttdeci">mtb_ipc_mbox_receiver_t * mailbox</div><div class="ttdoc">Mailbox object for receiving secure requests over IPC.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:206</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_structmtb__srf__ipc__relay__context__cfg__t"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__relay__context__cfg__t">mtb_srf_ipc_relay_context_cfg_t</a></div><div class="ttdoc">Config to setup a relay context.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:204</div></div>
</div><!-- fragment --><p> Start Relay (Non-RTOS) </p><div class="fragment"><div class="line">mtb_srf_ipc_relay_context_t cb_relay;</div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// ipc_callback</span></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keywordtype">void</span> ipc_callback(<span class="keywordtype">void</span>* callback_arg, mtb_ipc_mbox_event_t event)</div>
<div class="line">{</div>
<div class="line">    CY_UNUSED_PARAMETER(callback_arg);</div>
<div class="line">    CY_UNUSED_PARAMETER(event);</div>
<div class="line">    <a class="code hl_function" href="group__group__mtb__srf__ipc.html#ga09a147eca2684b0c06f25f32d655e616">mtb_srf_ipc_receive_request</a>(&amp;cb_relay, 100);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// snippet_mtb_srf_ipc_relay_nonrtos</span></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line">cy_rslt_t snippet_mtb_srf_ipc_relay_nonrtos(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Assume Relay context is already initialized</span></div>
<div class="line">    mtb_ipc_mbox_receiver_enable_event(cb_relay.mailbox_handle,</div>
<div class="line">                                       MTB_IPC_MBOX_FULL,</div>
<div class="line">                                       <span class="keyword">true</span>);</div>
<div class="line">    mtb_ipc_mbox_receiver_register_callback(cb_relay.mailbox_handle, ipc_callback, NULL);</div>
<div class="line"> </div>
<div class="line">    cy_rslt_t result = <a class="code hl_function" href="group__group__mtb__srf__ipc.html#gadfd0eba4e232e623142cf6530fb6164d">mtb_srf_ipc_process_pending_request</a>(&amp;cb_relay);</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="agroup__group__mtb__srf__ipc_html_ga09a147eca2684b0c06f25f32d655e616"><div class="ttname"><a href="group__group__mtb__srf__ipc.html#ga09a147eca2684b0c06f25f32d655e616">mtb_srf_ipc_receive_request</a></div><div class="ttdeci">cy_rslt_t mtb_srf_ipc_receive_request(mtb_srf_ipc_relay_context_t *relay_context, uint64_t timeout_us)</div><div class="ttdoc">Receives an SRF request over IPC and adds to either the queue if using an RTOS or the ringbuffer.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc.c:619</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc_html_gadfd0eba4e232e623142cf6530fb6164d"><div class="ttname"><a href="group__group__mtb__srf__ipc.html#gadfd0eba4e232e623142cf6530fb6164d">mtb_srf_ipc_process_pending_request</a></div><div class="ttdeci">cy_rslt_t mtb_srf_ipc_process_pending_request(mtb_srf_ipc_relay_context_t *relay_context)</div><div class="ttdoc">Process the SRF request pending in either the queue if using an RTOS or the ringbuffer.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc.c:698</div></div>
</div><!-- fragment --><p> Start Relay (RTOS) </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#if defined(CY_RTOS_AWARE) || defined(COMPONENT_RTOS_AWARE)</span></div>
<div class="line">cy_rslt_t snippet_mtb_srf_ipc_relay_rtos(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Assume Relay context is already initialized</span></div>
<div class="line"> </div>
<div class="line">    mtb_srf_ipc_relay_context_t relay;</div>
<div class="line">    cy_thread_t receive;</div>
<div class="line">    cy_thread_t process;</div>
<div class="line">    uint64_t thread_stack_receive[300];</div>
<div class="line">    uint64_t thread_stack_process[300];</div>
<div class="line"> </div>
<div class="line">    cy_rslt_t result = cy_rtos_thread_create(&amp;receive, &amp;mtb_srf_ipc_receive_thread,</div>
<div class="line">                                             <span class="stringliteral">&quot;Receive Thread&quot;</span>, &amp;thread_stack_receive,</div>
<div class="line">                                             <span class="keyword">sizeof</span>(thread_stack_receive),</div>
<div class="line">                                             CY_RTOS_PRIORITY_NORMAL, (cy_thread_arg_t)&amp;relay);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    result = cy_rtos_thread_create(&amp;process, &amp;mtb_srf_ipc_process_thread,</div>
<div class="line">                                   <span class="stringliteral">&quot;Process Thread&quot;</span>, &amp;thread_stack_process,</div>
<div class="line">                                   <span class="keyword">sizeof</span>(thread_stack_process),</div>
<div class="line">                                   CY_RTOS_PRIORITY_NORMAL, (cy_thread_arg_t)&amp;relay);</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
</div><!-- fragment --><p >Quick init of Client </p><div class="fragment"><div class="line">CY_SECTION_SHAREDMEM <a class="code hl_struct" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> srf_ipc_requests_simple[MTB_SRF_POOL_SIZE]</div>
<div class="line"><a class="code hl_define" href="group__group__mtb__srf.html#ga658a13a20dd628548ad16d7bd06cc278">_MTB_SRF_DATA_ALIGN</a>;</div>
<div class="line">uint32_t IPC_SEMAPHORE_INDEXES_SIMPLE[] = { 1UL, 2UL, 3UL, 4UL, 5UL, 6UL };</div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// snippet_mtb_srf_ipc_client_init</span></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line">cy_rslt_t snippet_mtb_srf_ipc_client_init(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Assume IPC instance already initialized</span></div>
<div class="line">    mtb_ipc_t ipc_inst_simple;</div>
<div class="line">    mtb_ipc_mbox_sender_t ipc_sender_simple;</div>
<div class="line">    mtb_srf_ipc_pool_t srf_ipc_pool_simple;</div>
<div class="line">    mtb_ipc_semaphore_t ipc_semaphores[IPC_NUM_REQ_IN_POOL];</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__client__init__cfg__t">mtb_srf_ipc_client_init_cfg_t</a> client_init_simple =</div>
<div class="line">    {</div>
<div class="line">        .<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#abc3634b00ab536f89b4816fca7c76c9d">ipc_instance</a>       = &amp;ipc_inst_simple,</div>
<div class="line">        .mailbox_handle     = &amp;ipc_sender_simple,</div>
<div class="line">        .ipc_sem_indexes    = IPC_SEMAPHORE_INDEXES_SIMPLE,</div>
<div class="line">        .srf_ipc_requests   = srf_ipc_requests_simple,</div>
<div class="line">        .srf_ipc_pool       = &amp;srf_ipc_pool_simple,</div>
<div class="line">        .semaphore_handles  = ipc_semaphores,</div>
<div class="line">        .mbox_idx           = 0UL,</div>
<div class="line">        .num_semaphores     = IPC_NUM_REQ_IN_POOL,</div>
<div class="line">        .num_requests       = IPC_NUM_REQ_IN_POOL</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    cy_rslt_t result = <a class="code hl_function" href="group__group__mtb__srf__ipc__init.html#gac64d4a91c5d10deb3c3beaf93433fbce">mtb_srf_ipc_client_init</a>(&amp;example_srf_client_context, &amp;client_init_simple);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__init_html_gac64d4a91c5d10deb3c3beaf93433fbce"><div class="ttname"><a href="group__group__mtb__srf__ipc__init.html#gac64d4a91c5d10deb3c3beaf93433fbce">mtb_srf_ipc_client_init</a></div><div class="ttdeci">cy_rslt_t mtb_srf_ipc_client_init(mtb_srf_ipc_client_context_t *context, mtb_srf_ipc_client_init_cfg_t *cfg)</div><div class="ttdoc">Initializes Semaphores, Mailbox, and sets up Client context This function requires that the IPC secti...</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_abc3634b00ab536f89b4816fca7c76c9d"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#abc3634b00ab536f89b4816fca7c76c9d">mtb_srf_ipc_client_init_cfg_t::ipc_instance</a></div><div class="ttdeci">mtb_ipc_t * ipc_instance</div><div class="ttdoc">Pointer to the initialized IPC instance.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:237</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_structmtb__srf__ipc__client__init__cfg__t"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__client__init__cfg__t">mtb_srf_ipc_client_init_cfg_t</a></div><div class="ttdoc">Config struct to set up entire SRF system including IPC mailbox, semaphores and Client context.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:229</div></div>
</div><!-- fragment --><p> Quick init of Relay </p><div class="fragment"><div class="line">CY_SECTION_SHAREDMEM mtb_ipc_mbox_data_t srf_ipc_mbox_data _MTB_IPC_DATA_ALIGN;</div>
<div class="line">CY_SECTION_SHAREDMEM mtb_ipc_semaphore_data_t sem_data_simple[IPC_NUM_REQ_IN_POOL];</div>
<div class="line">uint32_t IPC_SEMAPHORE_INDEXES_SIMPLE[] = { 1UL, 2UL, 3UL, 4UL, 5UL, 6UL };</div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// snippet_mtb_srf_ipc_relay_init</span></div>
<div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div>
<div class="line">cy_rslt_t snippet_mtb_srf_ipc_relay_init(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Assume IPC instance already initialized</span></div>
<div class="line">    mtb_ipc_t ipc_inst_simple;</div>
<div class="line">    mtb_ipc_mbox_receiver_t ipc_receiver_simple;</div>
<div class="line">    mtb_srf_ipc_relay_context_t mtb_srf_relay_context;</div>
<div class="line">    mtb_ipc_semaphore_t sem_arr_simple[IPC_NUM_REQ_IN_POOL];</div>
<div class="line">    <a class="code hl_struct" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__relay__init__cfg__t">mtb_srf_ipc_relay_init_cfg_t</a> relay_init_simple =</div>
<div class="line">    {</div>
<div class="line">        .<a class="code hl_variable" href="group__group__mtb__srf__ipc__structures.html#a17ca422e57cf82e01c24404a1f820969">ipc_instance</a>           = &amp;ipc_inst_simple,</div>
<div class="line">        .mailbox_handle         = &amp;ipc_receiver_simple,</div>
<div class="line">        .ipc_sem_indexes        =  IPC_SEMAPHORE_INDEXES_SIMPLE,</div>
<div class="line">        .mailbox_data           = &amp;srf_ipc_mbox_data,</div>
<div class="line">        .semaphore_data         = sem_data_simple,</div>
<div class="line">        .semaphore_handles      = sem_arr_simple,</div>
<div class="line">        .mbox_idx               = 0UL,</div>
<div class="line">        .mbox_read_sema_idx     = 10UL,</div>
<div class="line">        .mbox_write_sema_idx    = 11UL,</div>
<div class="line">        .num_semaphores         = IPC_NUM_REQ_IN_POOL,</div>
<div class="line">        .num_requests           = IPC_NUM_REQ_IN_POOL</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">    #if (defined(CY_RTOS_AWARE) || defined(COMPONENT_RTOS_AWARE))</span></div>
<div class="line">    cy_queue_t rtos_queue;</div>
<div class="line">    <span class="comment">// Queue must be initialzied before passing into relay init</span></div>
<div class="line">    relay_init_simple.ipc_req_queue = &amp;rtos_queue;</div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"> </div>
<div class="line">    cy_rslt_t result = mtb_srf_ipc_relay_init(&amp;mtb_srf_relay_context, &amp;relay_init_simple);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_a17ca422e57cf82e01c24404a1f820969"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#a17ca422e57cf82e01c24404a1f820969">mtb_srf_ipc_relay_init_cfg_t::ipc_instance</a></div><div class="ttdeci">mtb_ipc_t * ipc_instance</div><div class="ttdoc">Pointer to the initialized IPC instance.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:267</div></div>
<div class="ttc" id="agroup__group__mtb__srf__ipc__structures_html_structmtb__srf__ipc__relay__init__cfg__t"><div class="ttname"><a href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__relay__init__cfg__t">mtb_srf_ipc_relay_init_cfg_t</a></div><div class="ttdoc">Config struct to set up entire SRF system including IPC mailbox, semaphores and Relay context.</div><div class="ttdef"><b>Definition:</b> mtb_srf_ipc_init.h:255</div></div>
</div><!-- fragment --> <table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
API Reference</h2></td></tr>
<tr class="memitem:group__group__mtb__srf__ipc__structures"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc__structures.html">Data Structures</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gadb546ed2b55eface714442f8960b63e0"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#gadb546ed2b55eface714442f8960b63e0">mtb_srf_ipc_request_submit</a> (mtb_srf_ipc_client_context_t *client_context, <a class="el" href="group__group__mtb__srf__structures.html#structmtb__srf__invec__ns__t">mtb_srf_invec_ns_t</a> *inVec_ns, uint8_t inVec_cnt_ns, <a class="el" href="group__group__mtb__srf__structures.html#structmtb__srf__outvec__ns__t">mtb_srf_outvec_ns_t</a> *outVec_ns, uint8_t outVec_cnt_ns)</td></tr>
<tr class="memdesc:gadb546ed2b55eface714442f8960b63e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Submit a request from another core to a TrustZone enabled core.  <a href="group__group__mtb__srf__ipc.html#gadb546ed2b55eface714442f8960b63e0">More...</a><br /></td></tr>
<tr class="separator:gadb546ed2b55eface714442f8960b63e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga581aa6205d45c2c1694d5f743025fbf8"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#ga581aa6205d45c2c1694d5f743025fbf8">mtb_srf_ipc_pool_semaphore_alloc</a> (mtb_srf_ipc_pool_t *pool, uint16_t *sema_idx, uint32_t timeout_us)</td></tr>
<tr class="memdesc:ga581aa6205d45c2c1694d5f743025fbf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate IPC semaphore to use in signalling.  <a href="group__group__mtb__srf__ipc.html#ga581aa6205d45c2c1694d5f743025fbf8">More...</a><br /></td></tr>
<tr class="separator:ga581aa6205d45c2c1694d5f743025fbf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabbac2fad4a887ef353de051879c971b9"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#gabbac2fad4a887ef353de051879c971b9">mtb_srf_ipc_pool_req_alloc</a> (mtb_srf_ipc_pool_t *pool, <a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> **req, uint32_t timeout_us)</td></tr>
<tr class="memdesc:gabbac2fad4a887ef353de051879c971b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate secure request object within an SRF IPC request pool to act as a packet.  <a href="group__group__mtb__srf__ipc.html#gabbac2fad4a887ef353de051879c971b9">More...</a><br /></td></tr>
<tr class="separator:gabbac2fad4a887ef353de051879c971b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaff1196b717d14c255cbae655cac86871"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#gaff1196b717d14c255cbae655cac86871">mtb_srf_ipc_pool_semaphore_free</a> (mtb_srf_ipc_pool_t *pool, uint16_t sema_idx)</td></tr>
<tr class="memdesc:gaff1196b717d14c255cbae655cac86871"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate an IPC semaphore.  <a href="group__group__mtb__srf__ipc.html#gaff1196b717d14c255cbae655cac86871">More...</a><br /></td></tr>
<tr class="separator:gaff1196b717d14c255cbae655cac86871"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3bf737e5d09eb26b40c107ddfb8cb859"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#ga3bf737e5d09eb26b40c107ddfb8cb859">mtb_srf_ipc_pool_req_free</a> (mtb_srf_ipc_pool_t *pool, const <a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> *req)</td></tr>
<tr class="memdesc:ga3bf737e5d09eb26b40c107ddfb8cb859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free secure request object within an SRF IPC request pool.  <a href="group__group__mtb__srf__ipc.html#ga3bf737e5d09eb26b40c107ddfb8cb859">More...</a><br /></td></tr>
<tr class="separator:ga3bf737e5d09eb26b40c107ddfb8cb859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ab93b57014e219c75bf8b40b86425e8"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#ga5ab93b57014e219c75bf8b40b86425e8">mtb_srf_ipc_request_send</a> (mtb_srf_ipc_client_context_t *client_context, <a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> *request, uint64_t timeout_us)</td></tr>
<tr class="memdesc:ga5ab93b57014e219c75bf8b40b86425e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a request from the non-secure side to the secure and blocks for a timeout until request is processed.  <a href="group__group__mtb__srf__ipc.html#ga5ab93b57014e219c75bf8b40b86425e8">More...</a><br /></td></tr>
<tr class="separator:ga5ab93b57014e219c75bf8b40b86425e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09a147eca2684b0c06f25f32d655e616"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#ga09a147eca2684b0c06f25f32d655e616">mtb_srf_ipc_receive_request</a> (mtb_srf_ipc_relay_context_t *relay_context, uint64_t timeout_us)</td></tr>
<tr class="memdesc:ga09a147eca2684b0c06f25f32d655e616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives an SRF request over IPC and adds to either the queue if using an RTOS or the ringbuffer.  <a href="group__group__mtb__srf__ipc.html#ga09a147eca2684b0c06f25f32d655e616">More...</a><br /></td></tr>
<tr class="separator:ga09a147eca2684b0c06f25f32d655e616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab67399245daf400cbd527ef4fe1fd6fc"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#gab67399245daf400cbd527ef4fe1fd6fc">mtb_srf_ipc_process_request</a> (<a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> *request)</td></tr>
<tr class="memdesc:gab67399245daf400cbd527ef4fe1fd6fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the SRF request from IPC.  <a href="group__group__mtb__srf__ipc.html#gab67399245daf400cbd527ef4fe1fd6fc">More...</a><br /></td></tr>
<tr class="separator:gab67399245daf400cbd527ef4fe1fd6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadfd0eba4e232e623142cf6530fb6164d"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#gadfd0eba4e232e623142cf6530fb6164d">mtb_srf_ipc_process_pending_request</a> (mtb_srf_ipc_relay_context_t *relay_context)</td></tr>
<tr class="memdesc:gadfd0eba4e232e623142cf6530fb6164d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the SRF request pending in either the queue if using an RTOS or the ringbuffer.  <a href="group__group__mtb__srf__ipc.html#gadfd0eba4e232e623142cf6530fb6164d">More...</a><br /></td></tr>
<tr class="separator:gadfd0eba4e232e623142cf6530fb6164d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf38cb2cbb204d42a8c15f152ab08de49"><td class="memItemLeft" align="right" valign="top">cy_rslt_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__mtb__srf__ipc.html#gaf38cb2cbb204d42a8c15f152ab08de49">mtb_srf_ipc_signal_complete</a> (mtb_srf_ipc_relay_context_t *relay_context, <a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> *request)</td></tr>
<tr class="memdesc:gaf38cb2cbb204d42a8c15f152ab08de49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signals to client that secure request has been completed and output can be read.  <a href="group__group__mtb__srf__ipc.html#gaf38cb2cbb204d42a8c15f152ab08de49">More...</a><br /></td></tr>
<tr class="separator:gaf38cb2cbb204d42a8c15f152ab08de49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="gadb546ed2b55eface714442f8960b63e0" name="gadb546ed2b55eface714442f8960b63e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadb546ed2b55eface714442f8960b63e0">&#9670;&nbsp;</a></span>mtb_srf_ipc_request_submit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_request_submit </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_client_context_t *&#160;</td>
          <td class="paramname"><em>client_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__group__mtb__srf__structures.html#structmtb__srf__invec__ns__t">mtb_srf_invec_ns_t</a> *&#160;</td>
          <td class="paramname"><em>inVec_ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>inVec_cnt_ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__group__mtb__srf__structures.html#structmtb__srf__outvec__ns__t">mtb_srf_outvec_ns_t</a> *&#160;</td>
          <td class="paramname"><em>outVec_ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>outVec_cnt_ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Submit a request from another core to a TrustZone enabled core. </p>
<dl class="section note"><dt>Note</dt><dd>Calling this API is handled internally. When the IPC library is present, calling <a class="el" href="group__group__mtb__srf.html#gab26cb37c7cd980689eb5f49a308b4595">mtb_srf_request_submit</a> from another core will redirect to this API. If the default <a class="el" href="group__group__mtb__srf.html#gab26cb37c7cd980689eb5f49a308b4595">mtb_srf_request_submit</a> is disabled via the Makefile define MTB_SRF_CUSTOM_REQUEST_SUBMIT, it becomes the user's responsibility to call this on non-Trustzone cores.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">client_context</td><td>Stores state that client process needs to track between calls. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">inVec_ns</td><td>Vector for all operation and SRF input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inVec_cnt_ns</td><td>Number of input vectors in inVec_ns array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">outVec_ns</td><td>Vector for all operation and SRF output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outVec_cnt_ns</td><td>Number of output vectors in outVec_ns array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of submission </dd></dl>

</div>
</div>
<a id="ga581aa6205d45c2c1694d5f743025fbf8" name="ga581aa6205d45c2c1694d5f743025fbf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga581aa6205d45c2c1694d5f743025fbf8">&#9670;&nbsp;</a></span>mtb_srf_ipc_pool_semaphore_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_pool_semaphore_alloc </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>sema_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeout_us</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate IPC semaphore to use in signalling. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pool</td><td>The pool object that was populated by <a class="el" href="group__group__mtb__srf__pool__init.html#ga4656949c083236dd8f93fa2cc347fb97">mtb_srf_pool_init</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sema_idx</td><td>Pointer to the semaphore index that will be allocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout_us</td><td>Timeout to wait in microsecond. Set to 0 to perform no wait.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of allocate request </dd></dl>

</div>
</div>
<a id="gabbac2fad4a887ef353de051879c971b9" name="gabbac2fad4a887ef353de051879c971b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabbac2fad4a887ef353de051879c971b9">&#9670;&nbsp;</a></span>mtb_srf_ipc_pool_req_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_pool_req_alloc </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> **&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeout_us</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate secure request object within an SRF IPC request pool to act as a packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pool</td><td>The pool object that was populated by <a class="el" href="group__group__mtb__srf__pool__init.html#ga4656949c083236dd8f93fa2cc347fb97">mtb_srf_pool_init</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">req</td><td>Pointer to an SRF IPC request object. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout_us</td><td>Timeout to wait in microsecond. Set to 0 to perform no wait.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The timeout_us must always be 0 if allocation is invoked from an interrupt context. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>the status of allocate request </dd></dl>

</div>
</div>
<a id="gaff1196b717d14c255cbae655cac86871" name="gaff1196b717d14c255cbae655cac86871"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaff1196b717d14c255cbae655cac86871">&#9670;&nbsp;</a></span>mtb_srf_ipc_pool_semaphore_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_pool_semaphore_free </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>sema_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate an IPC semaphore. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pool</td><td>The pool object that was populated by <a class="el" href="group__group__mtb__srf__pool__init.html#ga4656949c083236dd8f93fa2cc347fb97">mtb_srf_pool_init</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sema_idx</td><td>Index of semaphore to be deallocated from the pool.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of allocate request </dd></dl>

</div>
</div>
<a id="ga3bf737e5d09eb26b40c107ddfb8cb859" name="ga3bf737e5d09eb26b40c107ddfb8cb859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3bf737e5d09eb26b40c107ddfb8cb859">&#9670;&nbsp;</a></span>mtb_srf_ipc_pool_req_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_pool_req_free </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free secure request object within an SRF IPC request pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pool</td><td>The pool object that was populated by <a class="el" href="group__group__mtb__srf__pool__init.html#ga4656949c083236dd8f93fa2cc347fb97">mtb_srf_pool_init</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">req</td><td>Pointer to an MB SRF request for the pool to free</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of free request </dd></dl>

</div>
</div>
<a id="ga5ab93b57014e219c75bf8b40b86425e8" name="ga5ab93b57014e219c75bf8b40b86425e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ab93b57014e219c75bf8b40b86425e8">&#9670;&nbsp;</a></span>mtb_srf_ipc_request_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_request_send </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_client_context_t *&#160;</td>
          <td class="paramname"><em>client_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>timeout_us</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a request from the non-secure side to the secure and blocks for a timeout until request is processed. </p>
<p >This is a function that should be added any implementation of <a class="el" href="group__group__mtb__srf.html#gab26cb37c7cd980689eb5f49a308b4595">mtb_srf_request_submit</a>, either within the BSP or custom.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">client_context</td><td>Stores state that client process needs to track between calls. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">request</td><td>Pointer to SRF IPC request object that will be sent by mailbox. If this is of a type other than default <a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a>, then please override mtb_srf_ipc_process_request to handle additional parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout_us</td><td>Timeout (in uS) to attempt to send request over IPC and subsequently wait for a response.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of submission </dd></dl>

</div>
</div>
<a id="ga09a147eca2684b0c06f25f32d655e616" name="ga09a147eca2684b0c06f25f32d655e616"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga09a147eca2684b0c06f25f32d655e616">&#9670;&nbsp;</a></span>mtb_srf_ipc_receive_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_receive_request </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_relay_context_t *&#160;</td>
          <td class="paramname"><em>relay_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>timeout_us</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives an SRF request over IPC and adds to either the queue if using an RTOS or the ringbuffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">relay_context</td><td>Stores state that client process needs to track between calls. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout_us</td><td>Timeout (in uS) to attempt to receive request over IPC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of the receive. </dd></dl>
<p >No RTOS so we add to ring buffer</p>

</div>
</div>
<a id="gab67399245daf400cbd527ef4fe1fd6fc" name="gab67399245daf400cbd527ef4fe1fd6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab67399245daf400cbd527ef4fe1fd6fc">&#9670;&nbsp;</a></span>mtb_srf_ipc_process_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_process_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process the SRF request from IPC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">request</td><td>Secure request to prepare for processing. If this is of a type other than default <a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a>, please override this function to handle additional parameters. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of the request submit. </dd></dl>

</div>
</div>
<a id="gadfd0eba4e232e623142cf6530fb6164d" name="gadfd0eba4e232e623142cf6530fb6164d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadfd0eba4e232e623142cf6530fb6164d">&#9670;&nbsp;</a></span>mtb_srf_ipc_process_pending_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_process_pending_request </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_relay_context_t *&#160;</td>
          <td class="paramname"><em>relay_context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process the SRF request pending in either the queue if using an RTOS or the ringbuffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">relay_context</td><td>Stores state that client process needs to track between calls. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of the request submit. </dd></dl>

</div>
</div>
<a id="gaf38cb2cbb204d42a8c15f152ab08de49" name="gaf38cb2cbb204d42a8c15f152ab08de49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf38cb2cbb204d42a8c15f152ab08de49">&#9670;&nbsp;</a></span>mtb_srf_ipc_signal_complete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cy_rslt_t mtb_srf_ipc_signal_complete </td>
          <td>(</td>
          <td class="paramtype">mtb_srf_ipc_relay_context_t *&#160;</td>
          <td class="paramname"><em>relay_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__group__mtb__srf__ipc__structures.html#structmtb__srf__ipc__packet__t">mtb_srf_ipc_packet_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Signals to client that secure request has been completed and output can be read. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">relay_context</td><td>Stores state that client process needs to track between calls. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>Secure request to prepare for processing. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the status of the signalling </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>Secure Request Framework</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
