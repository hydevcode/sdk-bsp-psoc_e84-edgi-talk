<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSOC E8XXGP Device Support Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PSOC E8XXGP Device Support Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__group__smif.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">API Reference</a>  </div>
  <div class="headertitle"><div class="title">SMIF (Serial Memory Interface)<div class="ingroups"><a class="el" href="group__group__pdl__top.html">PDL API Reference</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<p >The SPI-based communication interface to the external quad SPI (QSPI) high-speed memory devices. </p>
<p >The functions and other declarations used in this driver are in cy_smif.h and cy_smif_memslot.h (if used). If you are using the ModusToolbox QSPI Configurator, also include cycfg_qspi_memslot.h.</p>
<p ><b>SMIF: Serial Memory Interface</b>: This IP block implements an SPI-based communication interface for interfacing external memory devices to the MCU. The SMIF supports SPI, dual SPI (DSPI), quad SPI (QSPI), dual QSPI and octal SPI.</p>
<p >Features</p><ul>
<li>Standard SPI Master interface</li>
<li>Supports single/dual/quad/octal SPI memory devices</li>
<li>Supports dual quad SPI mode</li>
<li>Design-time configurable support for multiple (up to 4) external serial memory devices</li>
<li>eXecute-In-Place (XIP) operation mode for both read and write accesses with 4KB XIP read cache and on-the-fly encryption and decryption</li>
<li>Supports external serial memory initialization via <a href="https://www.jedec.org/standards-documents/docs/jesd216b" target="_blank">Serial Flash Discoverable Parameters (SFDP)</a> standard</li>
</ul>
<p >The primary usage model for the SMIF is that of an external memory interface. The SMIF is capable of interfacing with different types of memory, up to four types.</p>
<p ><b>SMIF</b> driver is divided into three layers</p><ul>
<li>cy_smif.h API</li>
<li>cy_smif_memslot.h API</li>
<li>SMIF configuration structures</li>
</ul>
<p >The SMIF API is divided into the low-level functions and memory-slot functions. Use the low level API for the SMIF block initialization and for implementing a generic SPI communication interface using the SMIF block.</p>
<p >The memory slot API has functions to implement the basic memory operations such as program, read, erase etc. These functions are implemented using the memory parameters in the memory device configuration data structure. The <a class="el" href="group__group__smif__mem__slot__functions.html#ga6f38cc37ab0e6fcb97d2675d1ae11771" title="This function initializes the slots of the memory device in the SMIF configuration.">Cy_SMIF_MemInit()</a> API initializes all the memory slots based on the settings in the array.</p>
<div class="image">
<img src="smif_3_0_p01_layers.png" alt=""/>
</div>
<dl class="section note"><dt>Note</dt><dd>Above image is applicable only for SMIF v3 IP.</dd></dl>
<div class="image">
<img src="smif_1_0_p01_layers.png" alt=""/>
</div>
<dl class="section note"><dt>Note</dt><dd>Above image is applicable only for SMIF v1 IP.</dd></dl>
<p>The QSPI Configurator tool is a stand-alone application that is a part of ModusToolbox. It can be accessed within ModusToolbox via the Peripheral -&gt; Serial Memory Interface -&gt; External Tools -&gt; Launch QSPI Configurator button, or from the &lt;CY_TOOLS_PATHS&gt;/qspi-configurator directory.</p>
<p >The tool generates *.c and *.h file with configuration structures. These configuration structures are input parameters for cy_smif_memslot API level.</p>
<dl class="section warning"><dt>Warning</dt><dd>The driver is not responsible for external memory persistence. You cannot edit a buffer during the Read/Write operations. If there is a memory error, the SMIF ip block can require a reset. To determine if this has happened, check the SMIF busy status using <a class="el" href="group__group__smif__low__level__functions.html#ga58e965697047847ce906329eb6b5341c" title="This function provides the status of the IP block (False - not busy, True - busy).">Cy_SMIF_BusyCheck()</a> and implement a timeout. Reset the SMIF block by toggling CTL.ENABLED. Then reconfigure the SMIF block.</dd></dl>
<p>For the Write operation, check that the SMIF driver has completed transferring by calling <a class="el" href="group__group__smif__low__level__functions.html#ga58e965697047847ce906329eb6b5341c" title="This function provides the status of the IP block (False - not busy, True - busy).">Cy_SMIF_BusyCheck()</a>. Also, check that the memory is available with <a class="el" href="group__group__smif__mem__slot__functions.html#gae648d554521de4d840ace68af2db65a3" title="This function checks if the status of the memory device is busy.">Cy_SMIF_MemIsBusy()</a> before proceeding.</p>
<p >Simple example of external flash memory programming using low level SMIF API. All steps mentioned in example below are incorporated in <a class="el" href="group__group__smif__mem__slot__functions.html#gac93c10b75a6f4f69da062ee27515e3b5">Cy_SMIF_MemCmdWriteEnable()</a>, <a class="el" href="group__group__smif__mem__slot__functions.html#ga81dda3370adfb1c5ae37c4ff8657d527">Cy_SMIF_MemCmdProgram()</a>, and <a class="el" href="group__group__smif__mem__slot__functions.html#gae648d554521de4d840ace68af2db65a3">Cy_SMIF_MemIsBusy()</a> of the <a class="el" href="group__group__smif__mem__slot__functions.html">memory slot level API</a>. </p><dl class="section warning"><dt>Warning</dt><dd>Example is simplified, without checks of error conditions. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Flash memories need erase operation before programming. Refer to external memory datasheet for specific memory commands.</dd></dl>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Enable write operation in external memory. Send Write Enable command to</span></div>
<div class="line"><span class="comment">     * external memory.  */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga5abea630fca93c72faece8b23549cd11">Cy_SMIF_TransmitCommand</a>( SMIF,</div>
<div class="line">                            0x06U, <span class="comment">/* External memory write enable command */</span></div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                            CMD_WITHOUT_PARAM, <span class="comment">/* Command does not have parameters */</span></div>
<div class="line">                            CMD_WITHOUT_PARAM,</div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312ae942102fb4b1a03a13ca8950b607520d">CY_SMIF_SLAVE_SELECT_0</a>, <span class="comment">/* External memory connected to nSS0 */</span></div>
<div class="line">                            1U, <span class="comment">/* Disable nSS after command transferred */</span></div>
<div class="line">                            &amp;smifContext);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Wait while SMIF IP is transferring command to external memory */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group__group__smif__low__level__functions.html#ga58e965697047847ce906329eb6b5341c">Cy_SMIF_BusyCheck</a>(SMIF));</div>
<div class="line"> </div>
<div class="line">    uint8_t tst_txBuffer[TX_SIZE]; <span class="comment">/* Buffer to put read date */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Send page program command to external memory */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga5abea630fca93c72faece8b23549cd11">Cy_SMIF_TransmitCommand</a>( SMIF,</div>
<div class="line">                            0x02U,   <span class="comment">/* Page Program external memory command */</span></div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                            address,</div>
<div class="line">                            MEMORY_ADDRESS_SIZE,</div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312ae942102fb4b1a03a13ca8950b607520d">CY_SMIF_SLAVE_SELECT_0</a>,</div>
<div class="line">                            0U, <span class="comment">/* Not last byte, does not disable nSS line */</span></div>
<div class="line">                            &amp;smifContext);</div>
<div class="line">    <span class="comment">/* Send programming data to external memory */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#gae84cdf32e45e492e80dea38f9d3a7586">Cy_SMIF_TransmitData</a>(SMIF, tst_txBuffer, TX_SIZE, <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                            NULL, <span class="comment">/* Callback function is not used */</span></div>
<div class="line">                            &amp;smifContext);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Wait while SMIF transfers data */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group__group__smif__low__level__functions.html#ga58e965697047847ce906329eb6b5341c">Cy_SMIF_BusyCheck</a>(SMIF));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Wait until the memory is programed. Cy_SMIF_MemIsBusy() of memslot</span></div>
<div class="line"><span class="comment">     * API level could be used instead */</span></div>
<div class="line">    <span class="keywordtype">bool</span> memBusy;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">        uint8_t readReg = 0U;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Read the memory status register */</span></div>
<div class="line">        <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga5abea630fca93c72faece8b23549cd11">Cy_SMIF_TransmitCommand</a>( SMIF,</div>
<div class="line">                                0x05U, <span class="comment">/* Read status register of external memory */</span></div>
<div class="line">                                <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                                CMD_WITHOUT_PARAM,</div>
<div class="line">                                CMD_WITHOUT_PARAM,</div>
<div class="line">                                <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                                <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312ae942102fb4b1a03a13ca8950b607520d">CY_SMIF_SLAVE_SELECT_0</a>,</div>
<div class="line">                                0U, <span class="comment">/* Not last byte, does not disable nSS line */</span></div>
<div class="line">                                &amp;smifContext);</div>
<div class="line">        <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga1b365e1400ccd6580533a0c92deb48c7">Cy_SMIF_ReceiveData</a>(SMIF, &amp;readReg,</div>
<div class="line">                            1U, <span class="comment">/* Read 1-byte */</span></div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                            NULL, <span class="comment">/* Callback function is not used */</span></div>
<div class="line">                            &amp;smifContext);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Check if the SMIF IP is busy */</span></div>
<div class="line">        <span class="keywordflow">while</span>(<a class="code hl_function" href="group__group__smif__low__level__functions.html#ga58e965697047847ce906329eb6b5341c">Cy_SMIF_BusyCheck</a>(SMIF));</div>
<div class="line"> </div>
<div class="line">        memBusy = ((readReg &amp; MEM_WIP_MASK) != 0U);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">while</span>(memBusy);</div>
<div class="ttc" id="agroup__group__smif__enums_html_ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7"><div class="ttname"><a href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a></div><div class="ttdeci">@ CY_SMIF_WIDTH_SINGLE</div><div class="ttdoc">Single SPI mode.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:510</div></div>
<div class="ttc" id="agroup__group__smif__enums_html_ggad776a0db9224477ab865254a32d9e312ae942102fb4b1a03a13ca8950b607520d"><div class="ttname"><a href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312ae942102fb4b1a03a13ca8950b607520d">CY_SMIF_SLAVE_SELECT_0</a></div><div class="ttdeci">@ CY_SMIF_SLAVE_SELECT_0</div><div class="ttdoc">The SMIF slave select 0</div><div class="ttdef"><b>Definition:</b> cy_smif.h:728</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_ga1b365e1400ccd6580533a0c92deb48c7"><div class="ttname"><a href="group__group__smif__low__level__functions.html#ga1b365e1400ccd6580533a0c92deb48c7">Cy_SMIF_ReceiveData</a></div><div class="ttdeci">cy_en_smif_status_t Cy_SMIF_ReceiveData(SMIF_Type *base, uint8_t *rxBuffer, uint32_t size, cy_en_smif_txfr_width_t transferWidth, cy_smif_event_cb_t RxCompleteCb, cy_stc_smif_context_t *context)</div><div class="ttdoc">This function implements the receive data phase in the memory command.</div><div class="ttdef"><b>Definition:</b> cy_smif.c:762</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_ga58e965697047847ce906329eb6b5341c"><div class="ttname"><a href="group__group__smif__low__level__functions.html#ga58e965697047847ce906329eb6b5341c">Cy_SMIF_BusyCheck</a></div><div class="ttdeci">__STATIC_INLINE bool Cy_SMIF_BusyCheck(SMIF_Type const *base)</div><div class="ttdoc">This function provides the status of the IP block (False - not busy, True - busy).</div><div class="ttdef"><b>Definition:</b> cy_smif.h:1537</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_ga5abea630fca93c72faece8b23549cd11"><div class="ttname"><a href="group__group__smif__low__level__functions.html#ga5abea630fca93c72faece8b23549cd11">Cy_SMIF_TransmitCommand</a></div><div class="ttdeci">cy_en_smif_status_t Cy_SMIF_TransmitCommand(SMIF_Type *base, uint8_t cmd, cy_en_smif_txfr_width_t cmdTxfrWidth, uint8_t const cmdParam[], uint32_t paramSize, cy_en_smif_txfr_width_t paramTxfrWidth, cy_en_smif_slave_select_t slaveSelect, uint32_t completeTxfr, cy_stc_smif_context_t const *context)</div><div class="ttdoc">This function transmits a command byte followed by a parameter which is typically an address field.</div><div class="ttdef"><b>Definition:</b> cy_smif.c:550</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_gae84cdf32e45e492e80dea38f9d3a7586"><div class="ttname"><a href="group__group__smif__low__level__functions.html#gae84cdf32e45e492e80dea38f9d3a7586">Cy_SMIF_TransmitData</a></div><div class="ttdeci">cy_en_smif_status_t Cy_SMIF_TransmitData(SMIF_Type *base, uint8_t const *txBuffer, uint32_t size, cy_en_smif_txfr_width_t transferWidth, cy_smif_event_cb_t TxCompleteCb, cy_stc_smif_context_t *context)</div><div class="ttdoc">This function is used to transmit data using the SMIF interface.</div><div class="ttdef"><b>Definition:</b> cy_smif.c:628</div></div>
</div><!-- fragment --><p >For the Read operation, before accessing the read buffer, check that it is ready by calling <a class="el" href="group__group__smif__low__level__functions.html#ga10662c147b39a1b71a2f2221b0e3f59f" title="This function is used to read the status of the TX FIFO.">Cy_SMIF_GetTxFifoStatus()</a>.</p>
<p >Simple example of external flash memory read using low level SMIF API. All steps mentioned in example below are incorporated in <a class="el" href="group__group__smif__mem__slot__functions.html#ga8507571efa28c8187f5e3c795f59fab4">Cy_SMIF_MemCmdRead()</a> of the <a class="el" href="group__group__smif__mem__slot__functions.html">memory slot level API</a>. </p><dl class="section warning"><dt>Warning</dt><dd>Example is simplified, without checks of error conditions. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Refer to external memory datasheet for specific memory commands.</dd></dl>
<div class="fragment"><div class="line">     <span class="comment">/* Read memory data */</span></div>
<div class="line">    uint8_t address[MEMORY_ADDRESS_SIZE] = {0U,0U,0U}; <span class="comment">/* Read from 3-byte 0 address */</span></div>
<div class="line">    uint8_t tst_rxBuffer[RX_SIZE]; <span class="comment">/* Buffer to put read date */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga5abea630fca93c72faece8b23549cd11">Cy_SMIF_TransmitCommand</a>(SMIF,</div>
<div class="line">                            0x03U,    <span class="comment">/* External memory Read command code */</span></div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>, <span class="comment">/* Normal SPI mode */</span></div>
<div class="line">                            address,</div>
<div class="line">                            MEMORY_ADDRESS_SIZE,</div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                            <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312ae942102fb4b1a03a13ca8950b607520d">CY_SMIF_SLAVE_SELECT_0</a>, <span class="comment">/* External memory connected to nSS0 */</span></div>
<div class="line">                            0U, <span class="comment">/* Not last byte, does not disable nSS line */</span></div>
<div class="line">                            &amp;smifContext);</div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga1b365e1400ccd6580533a0c92deb48c7">Cy_SMIF_ReceiveData</a>(SMIF, tst_rxBuffer, RX_SIZE, <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggab71e4b1f4c80b3e8c82dd85570415e44ac1096798c3195819d57ad16de46b4ed7">CY_SMIF_WIDTH_SINGLE</a>,</div>
<div class="line">                            NULL, <span class="comment">/* Callback function is not used */</span></div>
<div class="line">                            &amp;smifContext);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check SMIF fishes reading operation */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group__group__smif__low__level__functions.html#ga90da2709c1d2a6967101a05e0eb27b08">Cy_SMIF_GetTransferStatus</a>(SMIF, &amp;smifContext) == <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggaf65a7e26c18fcd3d3469eb083f78bb85af8edf256d08cd59c856ed40dd78b9585">CY_SMIF_RX_BUSY</a>);</div>
<div class="ttc" id="agroup__group__smif__enums_html_ggaf65a7e26c18fcd3d3469eb083f78bb85af8edf256d08cd59c856ed40dd78b9585"><div class="ttname"><a href="group__group__smif__enums.html#ggaf65a7e26c18fcd3d3469eb083f78bb85af8edf256d08cd59c856ed40dd78b9585">CY_SMIF_RX_BUSY</a></div><div class="ttdeci">@ CY_SMIF_RX_BUSY</div><div class="ttdoc">The data reception is in progress.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:673</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_ga90da2709c1d2a6967101a05e0eb27b08"><div class="ttname"><a href="group__group__smif__low__level__functions.html#ga90da2709c1d2a6967101a05e0eb27b08">Cy_SMIF_GetTransferStatus</a></div><div class="ttdeci">cy_en_smif_txfr_status_t Cy_SMIF_GetTransferStatus(SMIF_Type const *base, cy_stc_smif_context_t const *context)</div><div class="ttdoc">This function provides the status of the transfer.</div><div class="ttdef"><b>Definition:</b> cy_smif.c:897</div></div>
</div><!-- fragment --><p >The user should invalidate the cache by calling <a class="el" href="group__group__smif__low__level__functions.html#ga72240c0ce8307c50b65c4fca45c9cd30" title="This function is used to invalidate/clear the fast cache, the slow cache or both.">Cy_SMIF_CacheInvalidate()</a> when switching from the MMIO mode to XIP mode.</p>
<h1><a class="anchor" id="group_smif_configuration"></a>
Configuration Considerations</h1>
<p >PDL API has common parameters: base, context, config described in <a class="el" href="page_getting_started.html#page_getting_started_pdl_design">PDL Design</a> section.</p>
<p >See the documentation for <a class="el" href="group__group__smif__low__level__functions.html#gaea2684847f04e2e7e2c85cfe7fd37881" title="This function initializes the SMIF block as a communication block.">Cy_SMIF_Init()</a> and <a class="el" href="group__group__smif__mem__slot__functions.html#ga6f38cc37ab0e6fcb97d2675d1ae11771" title="This function initializes the slots of the memory device in the SMIF configuration.">Cy_SMIF_MemInit()</a> for details on the required configuration structures and other initialization topics.</p>
<p >The normal (MMIO) mode is used for implementing a generic SPI/DSPI/QSPI/dual QSPI/octal SPI communication interface using the SMIF block. This interface can be used to implement special commands like Program/Erase of flash, memory device configuration, sleep mode entry for memory devices or other special commands specific to the memory device. The transfer width (SPI/DSPI/QSPI/octal SPI) of a transmission is a parameter set for each transmit/receive operation. So these can be changed at run time.</p>
<p >In a typical memory interface with flash memory, the SMIF is used in the memory mode when reading from the memory and it switches to the normal mode when writing to flash memory. A typical memory device has multiple types of commands.</p>
<p >The SMIF interface can be used to transmit different types of commands. Each command has different phases: command, dummy cycles, and transmit and receive data which require separate APIs.</p>
<h2><a class="anchor" id="group_smif_init"></a>
SMIF Initialization</h2>
<p >Create interrupt function and allocate memory for SMIF context structure </p><div class="fragment"><div class="line"><a class="code hl_struct" href="group__group__smif__data__structures.html#structcy__stc__smif__context__t">cy_stc_smif_context_t</a> smifContext;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> SMIF_Interrupt_User(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#gaedbec6f968745b8f594dd4b32e91ceba">Cy_SMIF_Interrupt</a>(SMIF, &amp;smifContext);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__smif__data__structures_html_structcy__stc__smif__context__t"><div class="ttname"><a href="group__group__smif__data__structures.html#structcy__stc__smif__context__t">cy_stc_smif_context_t</a></div><div class="ttdoc">The SMIF internal context data.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:994</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_gaedbec6f968745b8f594dd4b32e91ceba"><div class="ttname"><a href="group__group__smif__low__level__functions.html#gaedbec6f968745b8f594dd4b32e91ceba">Cy_SMIF_Interrupt</a></div><div class="ttdeci">__STATIC_INLINE void Cy_SMIF_Interrupt(SMIF_Type *base, cy_stc_smif_context_t *context)</div><div class="ttdoc">The Interrupt Service Routine for the SMIF.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:1572</div></div>
</div><!-- fragment --><p> SMIF driver initialization for low level API usage (cysmif.h) </p><div class="fragment"><div class="line"> </div>
<div class="line">    <span class="comment">/* Main configuration parameters*/</span></div>
<div class="line"><span class="preprocessor">    #define NUMBER_OF_EXTERNAL_MEM      (2U)</span></div>
<div class="line"><span class="preprocessor">    #define SMIF_PRIORITY               (1U)</span></div>
<div class="line"><span class="preprocessor">    #define TIMEOUT_1_S                 (1000U)</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* SMIF interrupt initialization */</span></div>
<div class="line"><span class="preprocessor">    #if defined (CY_DEVICE_CAT1A)</span></div>
<div class="line"><span class="preprocessor">    #define SMIF_INTERRUPT smif_interrupt_IRQn</span></div>
<div class="line"><span class="preprocessor">    #elif defined (CY_DEVICE_CAT1B)</span></div>
<div class="line"><span class="preprocessor">    #define SMIF_INTERRUPT smif_interrupt_normal_IRQn</span></div>
<div class="line"><span class="preprocessor">    #elif defined (CY_DEVICE_CAT1C)</span></div>
<div class="line"><span class="preprocessor">    #if (defined(SMIF_SMIF_NR) &amp;&amp; SMIF_SMIF_NR != 1)</span></div>
<div class="line"><span class="preprocessor">    #define SMIF_INTERRUPT smif_0_smif0_interrupt_IRQn</span></div>
<div class="line"><span class="preprocessor">    #else</span></div>
<div class="line"><span class="preprocessor">    #define SMIF_INTERRUPT smif_0_interrupt_IRQn</span></div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="preprocessor">    #elif (CY_IP_MXSMIF_VERSION == 6u)</span></div>
<div class="line"><span class="preprocessor">    #define SMIF_INTERRUPT smif_0_smif0_interrupt_nsec_IRQn </span><span class="comment">/* For SMIF0 CORE0 instance */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="group__group__sysint__data__structures.html#structcy__stc__sysint__t">cy_stc_sysint_t</a> smifIntConfig =</div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">        #if (CY_CPU_CORTEX_M0P)</span></div>
<div class="line">            <span class="comment">/* .intrSrc */</span> NvicMux7_IRQn,</div>
<div class="line">            <span class="comment">/* .cm0pSrc */</span> SMIF_INTERRUPT,</div>
<div class="line"><span class="preprocessor">        #elif (defined(CPUSS_SYSTEM_IRQ_PRESENT) &amp;&amp; CPUSS_SYSTEM_IRQ_PRESENT == 1)</span></div>
<div class="line">            <span class="comment">/* .intrSrc */</span> ((uint32_t)NvicMux7_IRQn &lt;&lt; <a class="code hl_define" href="group__group__sysint__macros.html#ga3b9f1b9de4f122495a8b6580ce500d9a">CY_SYSINT_INTRSRC_MUXIRQ_SHIFT</a>) | (uint32_t)SMIF_INTERRUPT,</div>
<div class="line">        #<span class="keywordflow">else</span></div>
<div class="line">            <span class="comment">/* .intrSrc */</span> SMIF_INTERRUPT, <span class="comment">/* SMIF interrupt number (non M0 core)*/</span></div>
<div class="line">        #endif</div>
<div class="line">        <span class="comment">/* .intrPriority */</span> SMIF_PRIORITY</div>
<div class="line">    };</div>
<div class="line">    (void) <a class="code hl_function" href="group__group__sysint__functions.html#gab2ff6820a898e9af3f780000054eea5d">Cy_SysInt_Init</a>(&amp;smifIntConfig, SMIF_Interrupt_User);</div>
<div class="line"> </div>
<div class="line">    __enable_irq(); <span class="comment">/* Enable global interrupts. */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Enable SMIF interrupt */</span></div>
<div class="line"><span class="preprocessor">    #if ((__CORTEX_M == 0) || (defined(CPUSS_SYSTEM_IRQ_PRESENT) &amp;&amp; CPUSS_SYSTEM_IRQ_PRESENT == 1))</span></div>
<div class="line">        NVIC_EnableIRQ(NvicMux7_IRQn);</div>
<div class="line"><span class="preprocessor">    #else</span></div>
<div class="line">        NVIC_EnableIRQ(SMIF_INTERRUPT);</div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* SMIF configuration parameters */</span></div>
<div class="line">    <a class="code hl_struct" href="group__group__smif__data__structures.html#structcy__stc__smif__config__t">cy_stc_smif_config_t</a> tst_smifConfig =</div>
<div class="line">    {</div>
<div class="line">        .<a class="code hl_variable" href="group__group__smif__data__structures.html#aafd7927f913f7ce00475898ca8a032f8">mode</a>           =  <a class="code hl_enumvalue" href="group__group__smif__enums.html#gga2baa7c37d2cedf2e2c837facc753ab5da4fe852fb31547c77b31203ec5c43ca91">CY_SMIF_NORMAL</a>,      <span class="comment">/* Mode of operation */</span></div>
<div class="line">        .deselectDelay  =  DESELECT_DELAY,      <span class="comment">/* Minimum duration of SPI deselection */</span></div>
<div class="line">        .rxClockSel     =  <a class="code hl_enumvalue" href="group__group__smif__enums.html#gga6a2149f74b63ec4ebc76b99a9eb633d2a2e6388423a1b56880779651f73b3d2b7">CY_SMIF_SEL_INVERTED_INTERNAL_CLK</a>,     <span class="comment">/* Clock source for the receiver clock */</span></div>
<div class="line">        .blockEvent     =  <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggaf2f886b17b9d40712b212e704665341ea4ee6427df49e552167b2eb7a70f4afc4">CY_SMIF_BUS_ERROR</a>    <span class="comment">/* What happens when there is a read</span></div>
<div class="line"><span class="comment">                                                 * to an empty RX FIFO or write to a full TX FIFO</span></div>
<div class="line"><span class="comment">                                                 */</span></div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* SMIF initialization */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#gaea2684847f04e2e7e2c85cfe7fd37881">Cy_SMIF_Init</a>(SMIF, &amp;tst_smifConfig, TIMEOUT_1_S, &amp;smifContext);</div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga5428ca682fd56b837a1a3763fc2596b8">Cy_SMIF_Enable</a>(SMIF, &amp;smifContext);</div>
<div class="line"> </div>
<div class="ttc" id="agroup__group__smif__data__structures_html_aafd7927f913f7ce00475898ca8a032f8"><div class="ttname"><a href="group__group__smif__data__structures.html#aafd7927f913f7ce00475898ca8a032f8">cy_stc_smif_config_t::mode</a></div><div class="ttdeci">uint32_t mode</div><div class="ttdoc">Specifies the mode of operation cy_en_smif_mode_t.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:961</div></div>
<div class="ttc" id="agroup__group__smif__data__structures_html_structcy__stc__smif__config__t"><div class="ttname"><a href="group__group__smif__data__structures.html#structcy__stc__smif__config__t">cy_stc_smif_config_t</a></div><div class="ttdoc">The SMIF configuration structure.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:960</div></div>
<div class="ttc" id="agroup__group__smif__enums_html_gga2baa7c37d2cedf2e2c837facc753ab5da4fe852fb31547c77b31203ec5c43ca91"><div class="ttname"><a href="group__group__smif__enums.html#gga2baa7c37d2cedf2e2c837facc753ab5da4fe852fb31547c77b31203ec5c43ca91">CY_SMIF_NORMAL</a></div><div class="ttdeci">@ CY_SMIF_NORMAL</div><div class="ttdoc">Command mode (MMIO mode).</div><div class="ttdef"><b>Definition:</b> cy_smif.h:570</div></div>
<div class="ttc" id="agroup__group__smif__enums_html_gga6a2149f74b63ec4ebc76b99a9eb633d2a2e6388423a1b56880779651f73b3d2b7"><div class="ttname"><a href="group__group__smif__enums.html#gga6a2149f74b63ec4ebc76b99a9eb633d2a2e6388423a1b56880779651f73b3d2b7">CY_SMIF_SEL_INVERTED_INTERNAL_CLK</a></div><div class="ttdeci">@ CY_SMIF_SEL_INVERTED_INTERNAL_CLK</div><div class="ttdoc">The SMIF internal inverted clock.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:750</div></div>
<div class="ttc" id="agroup__group__smif__enums_html_ggaf2f886b17b9d40712b212e704665341ea4ee6427df49e552167b2eb7a70f4afc4"><div class="ttname"><a href="group__group__smif__enums.html#ggaf2f886b17b9d40712b212e704665341ea4ee6427df49e552167b2eb7a70f4afc4">CY_SMIF_BUS_ERROR</a></div><div class="ttdeci">@ CY_SMIF_BUS_ERROR</div><div class="ttdoc">Generates a bus error.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:521</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_ga5428ca682fd56b837a1a3763fc2596b8"><div class="ttname"><a href="group__group__smif__low__level__functions.html#ga5428ca682fd56b837a1a3763fc2596b8">Cy_SMIF_Enable</a></div><div class="ttdeci">void Cy_SMIF_Enable(SMIF_Type *base, cy_stc_smif_context_t *context)</div><div class="ttdoc">Enables the operation of the SMIF block.</div><div class="ttdef"><b>Definition:</b> cy_smif.c:921</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_gaea2684847f04e2e7e2c85cfe7fd37881"><div class="ttname"><a href="group__group__smif__low__level__functions.html#gaea2684847f04e2e7e2c85cfe7fd37881">Cy_SMIF_Init</a></div><div class="ttdeci">cy_en_smif_status_t Cy_SMIF_Init(SMIF_Type *base, cy_stc_smif_config_t const *config, uint32_t timeout, cy_stc_smif_context_t *context)</div><div class="ttdoc">This function initializes the SMIF block as a communication block.</div><div class="ttdef"><b>Definition:</b> cy_smif.c:75</div></div>
<div class="ttc" id="agroup__group__sysint__data__structures_html_structcy__stc__sysint__t"><div class="ttname"><a href="group__group__sysint__data__structures.html#structcy__stc__sysint__t">cy_stc_sysint_t</a></div><div class="ttdoc">Initialization configuration structure for a single interrupt channel.</div><div class="ttdef"><b>Definition:</b> cy_sysint.h:225</div></div>
<div class="ttc" id="agroup__group__sysint__functions_html_gab2ff6820a898e9af3f780000054eea5d"><div class="ttname"><a href="group__group__sysint__functions.html#gab2ff6820a898e9af3f780000054eea5d">Cy_SysInt_Init</a></div><div class="ttdeci">cy_en_sysint_status_t Cy_SysInt_Init(const cy_stc_sysint_t *config, cy_israddress userIsr)</div><div class="ttdoc">Initializes the referenced interrupt by setting the priority and the interrupt vector.</div><div class="ttdef"><b>Definition:</b> cy_sysint_v2.c:80</div></div>
<div class="ttc" id="agroup__group__sysint__macros_html_ga3b9f1b9de4f122495a8b6580ce500d9a"><div class="ttname"><a href="group__group__sysint__macros.html#ga3b9f1b9de4f122495a8b6580ce500d9a">CY_SYSINT_INTRSRC_MUXIRQ_SHIFT</a></div><div class="ttdeci">#define CY_SYSINT_INTRSRC_MUXIRQ_SHIFT</div><div class="ttdoc">Bit 0-11 indicate system interrupt and bit 12-15 will indicate the CPU IRQ.</div><div class="ttdef"><b>Definition:</b> cy_sysint.h:177</div></div>
</div><!-- fragment --><p> Additional steps to initialize SMIF driver for memory slot level API usage (cy_smif_memslot.h). </p><div class="fragment"><div class="line"> </div>
<div class="line">    <span class="comment">/* Configuration parameters for memory S25FL512S*/</span></div>
<div class="line">    <a class="code hl_struct" href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__device__cfg__t">cy_stc_smif_mem_device_cfg_t</a> S25FL512S;</div>
<div class="line">    <span class="comment">/* Configuration parameters for memory configuration autodetection*/</span></div>
<div class="line">    <a class="code hl_struct" href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__device__cfg__t">cy_stc_smif_mem_device_cfg_t</a> autodetectedMemory;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__config__t">cy_stc_smif_mem_config_t</a> memSs0 =</div>
<div class="line">    {</div>
<div class="line">        .<a class="code hl_variable" href="group__group__smif__data__structures__memslot.html#a1ddf064315a00cf0929f632835ad5508">slaveSelect</a>    = <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312ae942102fb4b1a03a13ca8950b607520d">CY_SMIF_SLAVE_SELECT_0</a>,                    <span class="comment">/* Determines the slot number where the memory device is placed */</span></div>
<div class="line">        .flags          = <a class="code hl_define" href="group__group__smif__macros__flags.html#ga29c9ff0df16794497a73170841902770">CY_SMIF_FLAG_MEMORY_MAPPED</a> | <a class="code hl_define" href="group__group__smif__macros__flags.html#gae3932175eef63cefb6740f7b8287067a">CY_SMIF_FLAG_WRITE_ENABLE</a>, <span class="comment">/* Determines if the device is memory mapped. If enabled this memory slot will be initialized in System init */</span></div>
<div class="line">        .dataSelect     = <a class="code hl_enumvalue" href="group__group__smif__enums.html#gga6d9ba2ef785b94cf542c573a51a0eb58a7544d58a69a1a2308ebd0cac9099cd24">CY_SMIF_DATA_SEL0</a>,  <span class="comment">/* Data line selection options for a slave device */</span></div>
<div class="line">        .baseAddress    = 0x18000000UL,       <span class="comment">/* The base address the memory slave is mapped to in the PSoC memory map. Valid when memory mapped mode is enabled */</span></div>
<div class="line">        .memMappedSize  = 0xFFE00000UL,       <span class="comment">/* The size allocated in the PSoC memory map, for the memory slave device. The size is allocated from the base address</span></div>
<div class="line"><span class="comment">                                               * Valid when memory mapped mode is enabled */</span></div>
<div class="line">        .dualQuadSlots  = 0x0UL,</div>
<div class="line">        .deviceCfg      = &amp;S25FL512S,         <span class="comment">/* Configuration of the device */</span></div>
<div class="line"><span class="preprocessor">        #if(CY_IP_MXSMIF_VERSION&gt;=2)</span></div>
<div class="line">        .mergeTimeout = CY_SMIF_MERGE_TIMEOUT_256_CYCLES</div>
<div class="line"><span class="preprocessor">        #endif </span><span class="comment">/* CY_IP_MXSMIF_VERSION */</span><span class="preprocessor"></span></div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__config__t">cy_stc_smif_mem_config_t</a> memSs1 =</div>
<div class="line">    {</div>
<div class="line">        .<a class="code hl_variable" href="group__group__smif__data__structures__memslot.html#a1ddf064315a00cf0929f632835ad5508">slaveSelect</a>   = <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312abcce904a4fb5c59af91665287c2cc906">CY_SMIF_SLAVE_SELECT_1</a>,   <span class="comment">/* Determines the slot number where the memory device is placed */</span></div>
<div class="line">        .flags         = <a class="code hl_define" href="group__group__smif__macros__flags.html#ga23e01da45ea8e930e94279967557a1c5">CY_SMIF_FLAG_DETECT_SFDP</a>, <span class="comment">/* Determines if the device is memory mapped. If enabled this memory slot will be initialized in System init */</span></div>
<div class="line">        .dataSelect    = <a class="code hl_enumvalue" href="group__group__smif__enums.html#gga6d9ba2ef785b94cf542c573a51a0eb58adb81ab40b00daad8ed642d06a9fd96a4">CY_SMIF_DATA_SEL2</a>,        <span class="comment">/* Data line selection options for a slave device */</span></div>
<div class="line">        .baseAddress   = 0x0UL,</div>
<div class="line">        .memMappedSize = 0x0UL,</div>
<div class="line">        .dualQuadSlots = 0x0UL,</div>
<div class="line">        .deviceCfg     = &amp;autodetectedMemory,      <span class="comment">/* Configuration of the device */</span></div>
<div class="line"><span class="preprocessor">        #if(CY_IP_MXSMIF_VERSION&gt;=2)</span></div>
<div class="line">        .mergeTimeout  = CY_SMIF_MERGE_TIMEOUT_256_CYCLES</div>
<div class="line"><span class="preprocessor">        #endif </span><span class="comment">/* CY_IP_MXSMIF_VERSION */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__config__t">cy_stc_smif_mem_config_t</a>* smifMemConfigs[NUMBER_OF_EXTERNAL_MEM] = {</div>
<div class="line">        &amp;memSs0,</div>
<div class="line">        &amp;memSs1,</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Memslot level initialization */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__smif__mem__slot__functions.html#ga6f38cc37ab0e6fcb97d2675d1ae11771">Cy_SMIF_MemInit</a>(SMIF, &amp;smifBlockConfig, &amp;smifContext);</div>
<div class="ttc" id="agroup__group__smif__data__structures__memslot_html_a1ddf064315a00cf0929f632835ad5508"><div class="ttname"><a href="group__group__smif__data__structures__memslot.html#a1ddf064315a00cf0929f632835ad5508">cy_stc_smif_mem_config_t::slaveSelect</a></div><div class="ttdeci">cy_en_smif_slave_select_t slaveSelect</div><div class="ttdoc">Determines the slave select where the memory device is placed.</div><div class="ttdef"><b>Definition:</b> cy_smif_memslot.h:769</div></div>
<div class="ttc" id="agroup__group__smif__data__structures__memslot_html_structcy__stc__smif__mem__config__t"><div class="ttname"><a href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__config__t">cy_stc_smif_mem_config_t</a></div><div class="ttdoc">This SMIF memory configuration structure is used to store the memory configuration for the memory mod...</div><div class="ttdef"><b>Definition:</b> cy_smif_memslot.h:767</div></div>
<div class="ttc" id="agroup__group__smif__data__structures__memslot_html_structcy__stc__smif__mem__device__cfg__t"><div class="ttname"><a href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__device__cfg__t">cy_stc_smif_mem_device_cfg_t</a></div><div class="ttdoc">This configuration structure of the SMIF memory device is used to store device-specific parameters.</div><div class="ttdef"><b>Definition:</b> cy_smif_memslot.h:719</div></div>
<div class="ttc" id="agroup__group__smif__enums_html_gga6d9ba2ef785b94cf542c573a51a0eb58a7544d58a69a1a2308ebd0cac9099cd24"><div class="ttname"><a href="group__group__smif__enums.html#gga6d9ba2ef785b94cf542c573a51a0eb58a7544d58a69a1a2308ebd0cac9099cd24">CY_SMIF_DATA_SEL0</a></div><div class="ttdeci">@ CY_SMIF_DATA_SEL0</div><div class="ttdoc">smif.spi_data[0] = DATA0, smif.spi_data[1] = DATA1, ..., smif.spi_data[7] = DATA7.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:549</div></div>
<div class="ttc" id="agroup__group__smif__enums_html_gga6d9ba2ef785b94cf542c573a51a0eb58adb81ab40b00daad8ed642d06a9fd96a4"><div class="ttname"><a href="group__group__smif__enums.html#gga6d9ba2ef785b94cf542c573a51a0eb58adb81ab40b00daad8ed642d06a9fd96a4">CY_SMIF_DATA_SEL2</a></div><div class="ttdeci">@ CY_SMIF_DATA_SEL2</div><div class="ttdoc">smif.spi_data[4] = DATA0, smif.spi_data[5] = DATA1, ..., smif.spi_data[7] = DATA3.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:559</div></div>
<div class="ttc" id="agroup__group__smif__enums_html_ggad776a0db9224477ab865254a32d9e312abcce904a4fb5c59af91665287c2cc906"><div class="ttname"><a href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312abcce904a4fb5c59af91665287c2cc906">CY_SMIF_SLAVE_SELECT_1</a></div><div class="ttdeci">@ CY_SMIF_SLAVE_SELECT_1</div><div class="ttdoc">The SMIF slave select 1</div><div class="ttdef"><b>Definition:</b> cy_smif.h:729</div></div>
<div class="ttc" id="agroup__group__smif__macros__flags_html_ga23e01da45ea8e930e94279967557a1c5"><div class="ttname"><a href="group__group__smif__macros__flags.html#ga23e01da45ea8e930e94279967557a1c5">CY_SMIF_FLAG_DETECT_SFDP</a></div><div class="ttdeci">#define CY_SMIF_FLAG_DETECT_SFDP</div><div class="ttdoc">Enables the Autodetect using the SFDP.</div><div class="ttdef"><b>Definition:</b> cy_smif_memslot.h:93</div></div>
<div class="ttc" id="agroup__group__smif__macros__flags_html_ga29c9ff0df16794497a73170841902770"><div class="ttname"><a href="group__group__smif__macros__flags.html#ga29c9ff0df16794497a73170841902770">CY_SMIF_FLAG_MEMORY_MAPPED</a></div><div class="ttdeci">#define CY_SMIF_FLAG_MEMORY_MAPPED</div><div class="ttdoc">Determines if the device is memory-mapped.</div><div class="ttdef"><b>Definition:</b> cy_smif_memslot.h:92</div></div>
<div class="ttc" id="agroup__group__smif__macros__flags_html_gae3932175eef63cefb6740f7b8287067a"><div class="ttname"><a href="group__group__smif__macros__flags.html#gae3932175eef63cefb6740f7b8287067a">CY_SMIF_FLAG_WRITE_ENABLE</a></div><div class="ttdeci">#define CY_SMIF_FLAG_WRITE_ENABLE</div><div class="ttdoc">Enables the write capability for the memory slave in the memory-mapped mode.</div><div class="ttdef"><b>Definition:</b> cy_smif_memslot.h:89</div></div>
<div class="ttc" id="agroup__group__smif__mem__slot__functions_html_ga6f38cc37ab0e6fcb97d2675d1ae11771"><div class="ttname"><a href="group__group__smif__mem__slot__functions.html#ga6f38cc37ab0e6fcb97d2675d1ae11771">Cy_SMIF_MemInit</a></div><div class="ttdeci">cy_en_smif_status_t Cy_SMIF_MemInit(SMIF_Type *base, cy_stc_smif_block_config_t const *blockConfig, cy_stc_smif_context_t *context)</div><div class="ttdoc">This function initializes the slots of the memory device in the SMIF configuration.</div><div class="ttdef"><b>Definition:</b> cy_smif_memslot.c:101</div></div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Example does not include initialization of all needed configuration structures (<a class="el" href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__device__cfg__t">cy_stc_smif_mem_device_cfg_t</a>, <a class="el" href="group__group__smif__data__structures__memslot.html#structcy__stc__smif__mem__cmd__t">cy_stc_smif_mem_cmd_t</a>). SMIF/QSPI Configuration tool generates all configuration structures needed for memslot level API usage.</dd></dl>
<h2><a class="anchor" id="group_smif_xip_init"></a>
SMIF XIP Initialization</h2>
<p >The eXecute In Place (XIP) is a mode of operation where read or write commands to the memory device are directed through the SMIF without any use of API function calls. In this mode the SMIF block maps the AHB bus-accesses to external memory device addresses to make it behave similar to internal memory. This allows the CPU to execute code directly from external memory. This mode is not limited to code and is suitable also for data read and write accesses. The memory regions available for XIP addresses allocation are defined in a linker script file (.ld).</p>
<p >With SMIF V3 IP (and above), MMIO mode transactions are also allowed when the device is set to XIP mode. However, only blocking SMIF API's are expected to be used for erase or program operations as external flash will be busy for such operation and may not be available for XIP at that moment. User can make use of <a class="el" href="group__group__smif__mem__slot__functions.html#ga3754459e6dd69599c7646a03a7039136">Cy_SMIF_MemRead</a>, <a class="el" href="group__group__smif__mem__slot__functions.html#ga1906a54462e0cd85e6d5a6e6efc03c7a">Cy_SMIF_MemWrite</a>, <a class="el" href="group__group__smif__mem__slot__functions.html#ga0366724555c54f148c6bec37f084897c">Cy_SMIF_MemEraseSector</a> API's which ensure that user gets control only after completing the requested operation. This will ensure the transaction is complete and then switch back to XIP. In case user wishes to make use of low level API's like <a class="el" href="group__group__smif__low__level__functions.html#gaff84f79f1cb122fa25eb03f73b496e63">Cy_SMIF_TransmitCommand_Ext</a>, <a class="el" href="group__group__smif__low__level__functions.html#ga7c413cce1934b7d3e373f7f1e2270940">Cy_SMIF_TransmitData_Ext</a>, <a class="el" href="group__group__smif__low__level__functions.html#ga3be6006b4c0c72703db49623734eccd6">Cy_SMIF_SendDummyCycles_Ext</a> user has to ensure the code is not running already from XIP location and complete the operation before switching back to XIP mode of execution. Also, user has to bound his complete SMIF operation using <a class="el" href="group__group__syslib__functions.html#gae679f15a1702c159c105b596a8801105">Cy_SysLib_EnterCriticalSection</a> and <a class="el" href="group__group__syslib__functions.html#ga8c16343c075610b2888b0693f972b555">Cy_SysLib_ExitCriticalSection</a> so that there is no interruption for the operation due to any other interrupts.</p>
<div class="fragment"><div class="line"> </div>
<div class="line">    <span class="comment">/* SMIF IP initialization */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#gaea2684847f04e2e7e2c85cfe7fd37881">Cy_SMIF_Init</a>(SMIF, &amp;tst_smifConfig, TIMEOUT_1_S, &amp;smifContext);</div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga1df033f6664a2b41cf044f2c4ec60817">Cy_SMIF_SetDataSelect</a>(SMIF, <a class="code hl_enumvalue" href="group__group__smif__enums.html#ggad776a0db9224477ab865254a32d9e312ae942102fb4b1a03a13ca8950b607520d">CY_SMIF_SLAVE_SELECT_0</a>, <a class="code hl_enumvalue" href="group__group__smif__enums.html#gga6d9ba2ef785b94cf542c573a51a0eb58a7544d58a69a1a2308ebd0cac9099cd24">CY_SMIF_DATA_SEL0</a>);</div>
<div class="line">    <a class="code hl_function" href="group__group__smif__mem__slot__functions.html#ga6f38cc37ab0e6fcb97d2675d1ae11771">Cy_SMIF_MemInit</a>(SMIF, &amp;smifBlockConfig, &amp;smifContext);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Set XIP mode */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga957f49ed7cf091e9b9d736ee589f2583">Cy_SMIF_SetMode</a>(SMIF, <a class="code hl_enumvalue" href="group__group__smif__enums.html#gga2baa7c37d2cedf2e2c837facc753ab5da562131834e2b77b141db45354e8584ec">CY_SMIF_MEMORY</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__group__smif__low__level__functions.html#ga5428ca682fd56b837a1a3763fc2596b8">Cy_SMIF_Enable</a>(SMIF, (<a class="code hl_struct" href="group__group__smif__data__structures.html#structcy__stc__smif__context__t">cy_stc_smif_context_t</a> *)&amp;smifContext);</div>
<div class="ttc" id="agroup__group__smif__enums_html_gga2baa7c37d2cedf2e2c837facc753ab5da562131834e2b77b141db45354e8584ec"><div class="ttname"><a href="group__group__smif__enums.html#gga2baa7c37d2cedf2e2c837facc753ab5da562131834e2b77b141db45354e8584ec">CY_SMIF_MEMORY</a></div><div class="ttdeci">@ CY_SMIF_MEMORY</div><div class="ttdoc">XIP (eXecute In Place) mode.</div><div class="ttdef"><b>Definition:</b> cy_smif.h:571</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_ga1df033f6664a2b41cf044f2c4ec60817"><div class="ttname"><a href="group__group__smif__low__level__functions.html#ga1df033f6664a2b41cf044f2c4ec60817">Cy_SMIF_SetDataSelect</a></div><div class="ttdeci">void Cy_SMIF_SetDataSelect(SMIF_Type *base, cy_en_smif_slave_select_t slaveSelect, cy_en_smif_data_select_t dataSelect)</div><div class="ttdoc">This function configures the data select option for a specific slave.</div><div class="ttdef"><b>Definition:</b> cy_smif.c:420</div></div>
<div class="ttc" id="agroup__group__smif__low__level__functions_html_ga957f49ed7cf091e9b9d736ee589f2583"><div class="ttname"><a href="group__group__smif__low__level__functions.html#ga957f49ed7cf091e9b9d736ee589f2583">Cy_SMIF_SetMode</a></div><div class="ttdeci">void Cy_SMIF_SetMode(SMIF_Type *base, cy_en_smif_mode_t mode)</div><div class="ttdoc">Sets the mode of operation for the SMIF.</div><div class="ttdef"><b>Definition:</b> cy_smif.c:354</div></div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Example of input parameters initialization is in <a class="el" href="group__group__smif.html#group_smif_init">SMIF Initialization</a> section. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Functions that called from external memory should be declared with long call attribute.</dd></dl>
<h2><a class="anchor" id="group_smif_xip_crypto"></a>
SMIF XIP On-the-fly encryption</h2>
<p >In XIP mode, a cryptography component supports on-the-fly encryption for write data and on-the-fly decryption for read data. On-the-fly encryption/decryption in XIP mode can be enabled by setting the flags <a class="el" href="group__group__smif__macros__flags.html#ga4a63040de70e518360dc47c1afe146e3">CY_SMIF_FLAG_CRYPTO_ENABLE</a>. Encryption and decryption are based on the AES-128 forward block cipher: advanced encryption standard blockcipher with a 128-bit key. KEY[127:0] is a secret (private) key programmed into the CRYPTO_KEY3,...,CRYPTO_KEY0 registers using <a class="el" href="group__group__smif__low__level__functions.html#ga49e4163f4131d692405b9e9430ac61b6">Cy_SMIF_SetCryptoKey</a>. These registers are software write-only. A software read returns 0. In the SMIF hardware, by applying AES-128 with KEY[127:0] on a plaintext PT[127:0], we get a ciphertext CT[127:0]. In XIP mode, the XIP address is used as the plaintext PT[]. The resulting ciphertext CT[] is used on-the-fly and not software accessible. The XIP address is extended with the CRYPTO_INPUT3, ..., CRYPTO_INPUT0 registers. <a class="el" href="group__group__smif__low__level__functions.html#gac43fe9363025064cfa881b2bed68c645">Cy_SMIF_SetCryptoIV</a> can be used to set initialization vector (96-bits). In XIP mode, the resulting ciphertext CT[] (of the encrypted address) is XORed with the memory transfers read data or write data. Note that the AES-128 block cipher is on the address of the data and not on the data itself.</p>
<div class="image">
<img src="smif_xip_mode_functionality.png" alt=""/>
</div>
<h2><a class="anchor" id="group_smif_usage_rules"></a>
Rules for SMIF Block Usage</h2>
<ol type="1">
<li>All operations must use one or more dummy cycles between the Command and Address phase (when the MCU drives the data pins) and the device's Response phase (when the device drives the same data pins). Bus contention may occur if no (zero) dummy cycles are used.</li>
<li>Any transfer that does not allow dummy cycles (such as Register Status Reads) must use the single-bit transfer mode. In single-bit mode, the MCU drives the Command on the Data0 line and the device responds on the Data1 line, so bus contention cannot occur.</li>
</ol>
<h1><a class="anchor" id="group_smif_more_information"></a>
More Information</h1>
<p >More information regarding the Serial Memory Interface can be found in the component datasheet and the Technical Reference Manual (TRM).</p>
<p >More information regarding the QSPI Configurator tool are in QSPI Configurator user guide. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
API Reference</h2></td></tr>
<tr class="memitem:group__group__smif__macros"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__smif__macros.html">Macros</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__smif__functions"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__smif__functions.html">Functions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__smif__data__structures"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__smif__data__structures.html">Data Structures</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__smif__enums"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__smif__enums.html">Enumerated Types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>PSOC E8XXGP Device Support Library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
